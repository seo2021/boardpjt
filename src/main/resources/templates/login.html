<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>로그인 - StudyLog</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<!-- 헤더 -->
<header class="header">
    <div class="nav-container">
        <a th:href="@{/}" class="logo">
            <i class="fas fa-book-open"></i>
            StudyLog
        </a>

        <nav class="nav-links">
            <a th:href="@{/posts}" class="nav-link">학습 기록</a>
            <a th:href="@{/auth/register}" class="nav-link">회원가입</a>
            <a th:href="@{/auth/login}" class="nav-link active">로그인</a>
            <a th:href="@{/my-page}" class="nav-link">마이페이지</a>
        </nav>
    </div>
</header>

<!-- 메인 컨텐츠 -->
<main class="main-content">
    <div class="login-container">
        <h1 class="login-title">로그인</h1>
        <p class="login-subtitle">학습 여정을 계속해보세요</p>

        <!-- 에러 메시지 -->
        <div th:if="${error}" class="error-message">
            <i class="fas fa-exclamation-triangle"></i>
            <span th:text="${error}"></span>
        </div>

        <!-- 로그인 폼 -->
        <form th:action="@{/auth/login}" method="post" class="login-form" id="loginForm">
            <div class="form-group">
                <label for="username" class="form-label">사용자명</label>
                <input
                        type="text"
                        id="username"
                        name="username"
                        class="form-input"
                        placeholder="ID를 입력해주세요"
                        required
                        autocomplete="username"
                >
            </div>

            <div class="form-group">
                <label for="password" class="form-label">비밀번호</label>
                <input
                        type="password"
                        id="password"
                        name="password"
                        class="form-input"
                        placeholder="비밀번호를 입력해주세요"
                        required
                        autocomplete="current-password"
                >
            </div>

            <button type="submit" class="login-button" id="loginBtn">
                <i class="fas fa-sign-in-alt"></i>
                로그인
            </button>
        </form>

        <!-- 추가 링크 -->
        <div class="additional-links">
            <p class="link-text">아직 계정이 없으신가요?</p>
            <a th:href="@{/auth/register}" class="register-link">
                <i class="fas fa-user-plus"></i>
                회원가입하기
            </a>
        </div>
    </div>
</main>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('loginForm');
        const loginBtn = document.getElementById('loginBtn');
        const usernameInput = document.getElementById('username');
        const passwordInput = document.getElementById('password');

        // 폼 제출 시 로딩 상태 표시
        form.addEventListener('submit', function(e) {
            // 기본 유효성 검사
            if (!usernameInput.value.trim()) {
                e.preventDefault();
                usernameInput.focus();
                return;
            }

            if (!passwordInput.value) {
                e.preventDefault();
                passwordInput.focus();
                return;
            }

            // 로딩 상태 활성화
            loginBtn.classList.add('loading');
            loginBtn.disabled = true;
        });

        // Enter 키로 폼 제출
        passwordInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                form.submit();
            }
        });

        // 입력 필드 포커스 시 에러 메시지 숨기기
        [usernameInput, passwordInput].forEach(input => {
            input.addEventListener('focus', function() {
                const errorMsg = document.querySelector('.error-message');
                if (errorMsg) {
                    errorMsg.style.opacity = '0.5';
                }
            });

            input.addEventListener('blur', function() {
                const errorMsg = document.querySelector('.error-message');
                if (errorMsg) {
                    errorMsg.style.opacity = '1';
                }
            });
        });

        // 첫 번째 빈 입력 필드에 포커스
        if (!usernameInput.value) {
            usernameInput.focus();
        } else if (!passwordInput.value) {
            passwordInput.focus();
        }
    });
</script>
</body>
</html>